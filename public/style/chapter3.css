@import url('https://fonts.googleapis.com/css2?family=Shippori+Mincho+B1&family=Cormorant+Garamond:wght@500&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400&display=swap');

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: #000;
  color: #e9e9f1;
  font-family: "Shippori Mincho B1", serif;
  overflow-x: hidden;
  line-height: 2;
}

/* === èƒŒæ™¯ï¼ˆæœ¬æ–‡ã§ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ï¼‰=== */
.bg-image {
  position: fixed;
  inset: 0;
  background: url('/assets/bg_ch3.jpg') center/cover no-repeat;
  filter: brightness(0.65) contrast(1.1) blur(2px);
  z-index: -2;
  opacity: 0;
  transition: opacity 3s ease-in-out;
}
.bg-image.visible { opacity: 1; }

/* === é›¨ï¼ˆã‚¤ãƒ³ãƒˆãƒ­ä¸­ã‚‚å¸¸æ™‚ï¼‰ === */
canvas#ch3-bg {
  position: fixed;
  inset: 0;
  z-index: -1;
  mix-blend-mode: screen;
  opacity: 0.9;
}

/* === ã‚¤ãƒ³ãƒˆãƒ­ï¼ˆé»’ï¼‰ === */
#chapter-intro {
  position: fixed;
  inset: 0;
  background: #000;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 3;
  animation: introFade 7s ease forwards;
  pointer-events: none;
}
@keyframes introFade {
  0%, 80% { opacity: 1; }
  100% { opacity: 0; visibility: hidden; }
}

/* ===== ã‚¿ã‚¤ãƒˆãƒ«å‡ºç¾ ===== */
.intro-title span {
  display: inline-block;
  font-family: "Cormorant Garamond", serif;
  font-size: 3.8rem;
  color: #b693ff;
  opacity: 0;
  transform-origin: center;
  text-shadow:
    0 0 6px rgba(180, 130, 255, 0.7),
    0 0 14px rgba(200, 150, 255, 0.5),
    0 0 26px rgba(230, 200, 255, 0.3);
  animation: crackAppear 1.8s ease forwards;
}
.intro-title span:nth-child(1){ animation-delay: 0.2s; }
.intro-title span:nth-child(2){ animation-delay: 0.4s; }
.intro-title span:nth-child(3){ animation-delay: 0.6s; }
.intro-title span:nth-child(4){ animation-delay: 0.8s; }
.intro-title span:nth-child(5){ animation-delay: 1s; }

@keyframes crackAppear {
  0% {
    opacity: 0;
    transform: scale(1.4) rotate(4deg);
    filter: blur(6px);
  }
  70% {
    opacity: 1;
    transform: scale(1) rotate(0deg);
    filter: blur(0);
  }
  100% { opacity: 1; }
}

/* ===== ã‚¿ã‚¤ãƒˆãƒ«å´©å£Šï¼ˆå››æ–¹ã«æ•£ã‚‹ï¼‰ ===== */
@keyframes crackScatter {
  0% { opacity: 1; transform: translate(0, 0) scale(1); filter: blur(0); }
  100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0.8) rotate(var(--rot)); filter: blur(3px); }
}

.intro-title.shatter span {
  animation: crackScatter 1.8s ease forwards;
  opacity: 0;
}
.intro-title.shatter span:nth-child(1){ --tx: -100px; --ty: -80px; --rot: -20deg; }
.intro-title.shatter span:nth-child(2){ --tx: 80px; --ty: -60px; --rot: 15deg; }
.intro-title.shatter span:nth-child(3){ --tx: -70px; --ty: 70px; --rot: 10deg; }
.intro-title.shatter span:nth-child(4){ --tx: 90px; --ty: 90px; --rot: -15deg; }
.intro-title.shatter span:nth-child(5){ --tx: 0; --ty: 120px; --rot: 25deg; }

/* === ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ« === */
.intro-sub {
  font-family: "Cormorant Garamond", serif;
  font-size: 1.1rem;
  color: rgba(220, 200, 255, 0.8);
  margin-top: 1.2em;
  letter-spacing: 0.15em;
  opacity: 0;
  animation: fadeSub 2s ease 1.2s forwards;
}
@keyframes fadeSub { to { opacity: 1; } }

/* === å›ºå®šã‚¿ã‚¤ãƒˆãƒ« === */
.chapter-title-fixed {
  position: fixed;
  top: 2rem;
  left: 50%;
  transform: translateX(-50%);
  font-family: "Cormorant Garamond", serif;
  font-size: 1.1rem;
  color: rgba(180, 160, 255, 0.4);
  z-index: 2;
  letter-spacing: 0.1em;
}

/* === æœ¬æ–‡ === */
.chapter-text {
  position: relative;
  z-index: 1;
  max-width: 700px;
  margin: 0 auto;
  padding: 14vh 6% 12vh;
  font-size: 1.05rem;
  letter-spacing: 0.05em;
  opacity: 0;
  transform: translateY(40px);
  animation: fadeInText 2s ease 6.8s forwards;
  color: #f1efff;
  background: rgba(10, 10, 20, 0.6);
  backdrop-filter: blur(8px);
  border-radius: 16px;
  box-shadow: 0 0 40px rgba(0, 0, 0, 0.5);
}
@keyframes fadeInText {
  to { opacity: 1; transform: translateY(0); }
}

/* === ãƒã‚¢ã®ã‚»ãƒªãƒ• === */
.noah {
  color: #a58bff;
  font-family: "Fira Code", monospace;
  letter-spacing: 0.03em;
  display: inline-block;
  position: relative;
  white-space: pre-wrap;
  margin: 1.5em 0;
  opacity: 0;
  animation: fadeNoah 2s ease forwards;
  text-shadow:
    0 0 6px rgba(180, 130, 255, 0.6),
    0 0 12px rgba(200, 150, 255, 0.4),
    0 0 20px rgba(220, 170, 255, 0.25);
}
@keyframes fadeNoah { to { opacity: 1; } }

/* === æ¬¡ã®ç« ã¸ === */
.next-chapter {
  display: block;
  text-align: center;
  margin-top: 4em;
  font-family: "Cormorant Garamond", serif;
  color: rgba(200, 200, 255, 0.5);
  text-decoration: none;
  transition: 0.4s ease;
  letter-spacing: 0.08em;
}
.next-chapter:hover {
  color: #fff;
  text-shadow: 0 0 8px rgba(255,255,255,0.8);
}
/* ===============================
   ğŸ“± Responsive (ã‚¹ãƒãƒ›æœ€é©åŒ–)
   =============================== */
@media screen and (max-width: 768px) {
  body {
    font-size: 15px;
    line-height: 1.8;
  }

  /* === èƒŒæ™¯ === */
  .bg-image {
    filter: brightness(0.75) contrast(1.05) blur(1.2px);
    background-position: center top;
    background-attachment: scroll;
  }

  /* === ã‚¿ã‚¤ãƒˆãƒ« === */
  .intro-title span {
    font-size: 2.2rem; /* â† 3.8rem â†’ 2.2rem ã«ç¸®å° */
    text-align: center;
    line-height: 1.3;
  }

  .intro-sub {
    font-size: 0.9rem;
    margin-top: 0.8em;
    letter-spacing: 0.1em;
  }

  /* === å›ºå®šã‚¿ã‚¤ãƒˆãƒ« === */
  .chapter-title-fixed {
    top: 1.5rem;
    font-size: 0.95rem;
    color: rgba(180, 160, 255, 0.6);
    letter-spacing: 0.08em;
  }

  /* === æœ¬æ–‡ === */
  .chapter-text {
    max-width: 90%;
    margin: 0 auto;
    padding: 10vh 6%;
    font-size: 0.95rem;
    border-radius: 10px;
    background: rgba(15, 15, 30, 0.65);
    backdrop-filter: blur(5px);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
  }

  /* === ãƒã‚¢ã®ã‚»ãƒªãƒ• === */
  .noah {
    font-size: 0.9rem;
    line-height: 1.7;
    word-break: break-word;
    text-shadow:
      0 0 3px rgba(180, 130, 255, 0.4),
      0 0 6px rgba(200, 150, 255, 0.25);
  }

  /* === æ¬¡ç« ãƒªãƒ³ã‚¯ === */
  .next-chapter {
    font-size: 1rem;
    margin-top: 3em;
    color: rgba(220, 220, 255, 0.6);
  }

  .next-chapter:hover {
    color: #fff;
    text-shadow: 0 0 6px rgba(255,255,255,0.7);
  }
}
/* =====================================================
   ğŸ“± NOAH â€“ Smart Responsive System (å…¨ç« å…±é€š)
   ===================================================== */

@media (max-width: 768px) {
  /* ===== åŸºæœ¬ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆèª¿æ•´ ===== */
  body {
    line-height: 1.9;
    font-size: 0.95rem;
    overflow-x: hidden;
  }

  /* èƒŒæ™¯ */
  .bg-image,
  .memory-bg,
  .bg-lab {
    background-size: contain !important; /* â† coverã‹ã‚‰å¤‰æ›´ */
    background-position: center center !important;
    filter: brightness(0.9) contrast(1.05) blur(1.2px);
  }

  /* ===== ç« ã‚¿ã‚¤ãƒˆãƒ« ===== */
  .chapter-title-fixed {
    position: relative !important; /* â† fixedè§£é™¤ */
    top: auto !important;
    text-align: center;
    margin-top: 8vh;
    margin-bottom: 4vh;
    font-size: 1.2rem !important;
    color: rgba(255, 255, 255, 0.75);
  }

  /* ===== æœ¬æ–‡ ===== */
  .chapter-text,
  .text-box {
    max-width: 90%;
    padding: 10vh 5% 16vh;
    font-size: 0.95rem;
    line-height: 1.9;
    background: rgba(255,255,255,0.35);
    backdrop-filter: blur(4px);
    border-radius: 12px;
  }

  /* ===== ãƒã‚¢ã®ã‚»ãƒªãƒ• ===== */
  .noah {
    font-size: 0.92rem;
    letter-spacing: 0.03em;
  }

  /* ===== æ¬¡ç« ãƒªãƒ³ã‚¯ ===== */
  .next-chapter {
    display: block;
    text-align: center;
    margin: 6vh auto 10vh;
    font-size: 1rem;
    letter-spacing: 0.05em;
  }
}
